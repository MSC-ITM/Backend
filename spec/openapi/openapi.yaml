
openapi: 3.1.0
info:
  title: Workflow Orchestration API
  version: 0.1.0
servers:
  - url: /api/v0
paths:
  /healthz:
    get:
      operationId: healthz
      responses:
        '200':
          description: ok
  /workflows:
    post:
      summary: Crear workflow (draft)
      responses:
        '201':
          description: Created
          content:
            application/json:
              example:
                id: wf_01H...
                version: 1
                status: draft
    get:
      summary: Listar workflows
      responses:
        '200':
          description: OK
          content:
            application/json:
              example:
                items: []
                limit: 50
                offset: 0
                total: 0
  /workflows/{workflowId}:
    get:
      summary: Obtener workflow por id
      parameters:
        - in: path
          name: workflowId
          required: true
          schema: { type: string }
      responses:
        '200':
          description: OK
        '404':
          description: Not Found
    put:
      summary: Actualizar workflow (solo draft)
      responses:
        '200':
          description: OK
        '409':
          description: Conflict
  /workflows/{workflowId}:publish:
    post:
      summary: Publicar workflow
      responses:
        '200':
          description: OK
  /workflows/{workflowId}:validate:
    post:
      summary: Validar workflow (lint)
      responses:
        '200':
          description: OK
          content:
            application/json:
              example:
                valid: false
                issues:
                  - path: nodes[0].config.url
                    msg: must be https
                    level: error
  /catalog/nodes:
    get:
      summary: Catálogo de nodos
      responses:
        '200':
          description: OK
          content:
            application/json:
              example:
                items:
                  - type: http.request
                    display: { label: HTTP Request }
                  - type: logic.switch
                    display: { label: Switch (If) }
  /runs:
    post:
      summary: Crear ejecución de workflow
      responses:
        '201':
          description: Created
  /runs/{runId}:
    get:
      summary: Obtener ejecución
      parameters:
        - in: path
          name: runId
          required: true
          schema: { type: string }
      responses:
        '200':
          description: OK
        '404':
          description: Not Found
  /runs/{runId}/artifacts:
    get:
      summary: Listar artefactos
      responses:
        '200':
          description: OK
components: {}
